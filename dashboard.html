<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Devedores - Sistema Financeiro</title>
    <link rel="stylesheet" href="style.css"> 
    <link rel="icon" href="logo.png" type="image/png">
</head>
<body class="dark-theme">
    <div class="dashboard-container">

        <header class="header">
            <h1 class="header-title">
                <img src="logo.png" alt="Logo" class="app-logo"> 
                Sistema de Empr√©stimos P2P
            </h1>
            
            <div class="header-actions">
                <button id="openAddDebtorModal" class="button">
                    + Adicionar Devedor
                </button>

                <div class="header-menu">
                    <button id="menuButton" class="button button-icon">‚öôÔ∏è</button>
                    <div id="menuDropdown" class="menu-dropdown">
                        
                        <button id="themeToggleButton" class="button-menu">
                            <span class="theme-icon"></span> Mudar Tema
                        </button>
                        
                        <button id="logoutButton" class="button-menu button-danger">
                            üö™ Sair
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <section class="statistics-section">
            <div class="stats-card">
                <h3>Total Emprestado</h3>
                <p id="totalEmprestado">R$ 0,00</p>
            </div>
            <div class="stats-card">
                <h3>Clientes Ativos</h3>
                <p id="clientesAtivos">0</p>
            </div>
            <div class="stats-card">
                <h3>Total a Receber (L√≠quido)</h3>
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <p id="totalAReceber" class="blurred-text">R$ 0,00</p>
                    <label class="toggle-switch-small">
                        <input type="checkbox" id="showTotalToggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
        </section>

        <section class="filter-section">
            <h2>Devedores</h2>
            <div class="filter-actions" id="filterActions">
                <button class="button-small filter-button filter-active" data-filter="todos">Todos</button>
                <button class="button-small filter-button" data-filter="diarios">Di√°rios</button>
                <button class="button-small filter-button" data-filter="semanais">Semanais</button>
                <button class="button-small filter-button" data-filter="mensais">Mensais</button>

                <select id="statusFilter" class="input-group select" style="width: auto;">
                    <option value="todos">Status: Todos</option>
                    <option value="ativo">Status: Ativo</option>
                    <option value="quitado">Status: Quitado</option>
                    <option value="atrasado">Status: Atrasado</option>
                </select>

                <div class="view-toggle-group">
                    <button id="listViewButton" class="button-small list-icon filter-active" data-view="list"></button>
                    <button id="cardViewButton" class="button-small card-icon" data-view="card"></button>
                </div>
            </div>
        </section>

        <section class="debtors-section">
            <div id="debtorsList" class="debtors-list list-view">
                <p id="noDebtorsMessage" class="loading-message" style="display: none;">Nenhum devedor encontrado.</p>
                <p id="loadingMessage" class="loading-message">Carregando dados...</p>
            </div>
        </section>
        
    </div>

    <div id="addDebtorModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeAddDebtorModal">&times;</span>
            <h2 id="modalTitle">Adicionar Novo Devedor</h2>
            <form id="debtorForm">
                <input type="hidden" id="debtorId">
                <div class="input-group">
                    <label for="name">Nome Completo</label>
                    <input type="text" id="name" required>
                </div>
                <div class="input-group">
                    <label for="contact">Contato (Telefone/Email)</label>
                    <input type="text" id="contact" placeholder="Ex: (11) 98765-4321">
                </div>
                <div class="input-group">
                    <label for="loanAmount">Valor do Empr√©stimo (R$)</label>
                    <input type="number" id="loanAmount" step="0.01" required>
                </div>
                <div class="input-group">
                    <label for="notes">Observa√ß√µes</label>
                    <textarea id="notes" rows="3"></textarea>
                </div>
                
                <div class="modal-footer-actions">
                    <button type="submit" class="button" id="saveDebtorButton">Salvar Devedor</button>
                    <button type="button" class="button-secondary" id="cancelDebtorButton">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <div id="detailsModal" class="modal fullscreen-modal">
        <div class="modal-content">
            <div class="fullscreen-modal-header">
                <h2 id="detailDebtorName">Detalhes do Devedor</h2>
                <span class="close-button" id="closeDetailsModal">&times;</span>
            </div>

            <div class="debtor-details-info">
                <p>Nome: <strong><span id="detailName"></span></strong></p>
                <p>Contato: <strong><span id="detailContact"></span></strong></p>
                <p>Total Emprestado: <strong><span id="detailLoanAmount"></span></strong></p>
                <p>Total Pago: <strong><span id="detailTotalPaid"></span></strong></p>
                <p>Total a Pagar (Restante): <strong><span id="detailRemainingAmount"></span></strong></p>
                <p>Status: <strong><span id="detailStatus"></span></strong></p>
            </div>

            <div class="input-group">
                 <label>Observa√ß√µes:</label>
                 <p id="detailNotes"></p>
            </div>

            <div class="payment-header">
                <h3>Pagamentos</h3>
                <button id="openAddPaymentModal" class="button button-small"> + Adicionar Pagamento</button>
            </div>

            <div id="paymentsGrid" class="payments-grid">
                </div>
            
            <div class="modal-footer-actions">
                <button type="button" class="button-danger" id="deleteDebtorButton">Excluir Devedor</button>
                <button type="button" class="button-secondary" id="editDebtorDetailsButton">Editar Devedor</button>
            </div>
        </div>
    </div>
    
    <div id="addPaymentModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeAddPaymentModal">&times;</span>
            <h2 id="paymentModalTitle">Adicionar Novo Pagamento</h2>
            <form id="paymentForm">
                <input type="hidden" id="paymentDebtorId">
                <input type="hidden" id="paymentId">
                
                <div class="input-group">
                    <label for="paymentValue">Valor (R$)</label>
                    <input type="number" id="paymentValue" step="0.01" required>
                </div>
                
                <div class="input-group">
                    <label for="paymentDueDate">Data de Vencimento (Fixo)</label>
                    <input type="date" id="paymentDueDate" required>
                </div>
                
                <div class="toggle-switch">
                    <input type="checkbox" id="paymentPaidStatus">
                    <label for="paymentPaidStatus">Marcar como Pago</label>
                </div>

                <div class="modal-footer-actions">
                    <button type="submit" class="button" id="savePaymentButton">Salvar Pagamento</button>
                    <button type="button" class="button-secondary" id="cancelPaymentButton">Cancelar</button>
                </div>
            </form>
        </div>
    </div>


    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
    <script src="script.js"></script>
</body>
</html>
